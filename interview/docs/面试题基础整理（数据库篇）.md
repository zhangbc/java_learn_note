# 面试题基础整理

## MySQL问题集

1、一张表，里面有 ID 自增主键，当 insert 了 17 条记录之后，删除了第 15,16,17 条记录， 再把 Mysql 重启，再 insert 一条记录，这条记录的 ID 是 18 还是 15 ？

> （1）如果表的类型是 MyISAM，那么是 18
>
> > 因为 MyISAM 表会把自增主键的最大 ID 记录到数据文件里，重启 MySQL 自增主键的最大 ID 也不会丢失。
>
> （2）如果表的类型是 InnoDB，那么是 15
>
> > InnoDB 表只是把自增主键的最大 ID 记录到内存中，所以重启数据库或者是对表进行 OPTIMIZE 操作，都会导致最大 ID 丢失。

2、Mysql 的技术特点是什么？

> Mysql 数据库软件是一个客户端或服务器系统，其中包括：支持各种客户端程序和库的多 线程 SQL 服务器、不同的后端、广泛的应用程序编程接口和管理工具。

3，Heap 表是什么？

> HEAP 表存在于内存中，用于临时高速存储
>
> BLOB 或 TEXT 字段是不允许的
>
> 只能使用比较运算符=，<，>，=>，= <
>
> HEAP 表不支持 AUTO_INCREMENT
>
> 索引不可为 NULL

4、Mysql 服务器默认端口是什么？

> Mysql 服务器的默认端口是 3306。

5，与 Oracle 相比，Mysql 有什么优势？

> Mysql 是开源软件，随时可用，无需付费；
>
> Mysql 是便携式的；
>
> 带有命令提示符的 GUI；
>
> 使用 Mysql 查询浏览器支持管理

6，如何区分 FLOAT 和 DOUBLE？

> 浮点数以 8 位精度存储在 FLOAT 中，并且有四个字节；
>
> 浮点数存储在 DOUBLE 中，精度为 18 位，有八个字节。

7，区分 CHAR_LENGTH 和 LENGTH？

> CHAR_LENGTH 是字符数，而 LENGTH 是字节数。Latin 字符的这两个数据是相同的，但是对 于 Unicode 和其他编码，它们是不同的。

8，请简洁描述 Mysql 中 InnoDB 支持的四种事务隔离级别名称，以及逐级之间的区别？ 

> SQL 标准定义的四个隔离级别为：
>
> read uncommited ：读到未提交数据
>
> read committed：脏读，不可重复读
>
> repeatable read：可重读
>
> serializable ：串行事物

9，在 Mysql 中 ENUM 的用法是什么？

> ENUM 是一个字符串对象，用于指定一组预定义的值，并可在创建表时使用。

```mysql
Create table size(name ENUM('Smail,'Medium','Large');
```

10，如何定义 REGEXP？

> REGEXP 是模式匹配，其中匹配模式在搜索值的任何位置。

11，CHAR 和 VARCHAR 的区别？

> CHAR 和 VARCHAR 类型在存储和检索方面有所不同；
>
> CHAR 列长度固定为创建表时声明的长度，长度值范围是 1 到 255；
>
> 当 CHAR 值被存储时，它们被用空格填充到特定长度，检索 CHAR 值时需删除尾随空格。

12，列的字符串类型可以是什么？

> 字符串类型是：
>
> SET
>
> BLOB
>
> ENUM
>
> CHAR
>
> TEXT
>
> VARCHAR

13，如何获取当前的 Mysql 版本？

```mysql
SELECT VERSION(); # 用于获取当前 Mysql 的版本。
```

14，Mysql 中使用什么存储引擎？ 

> 存储引擎称为表类型，数据使用各种技术存储在文件中。
>
> 技术涉及：
>
> > Storage mechanism
> >
> > Locking levels
> >
> > Indexing
> >
> > Capabilities
> >
> >  functions

15，Mysql 驱动程序是什么？

> PHP 驱动程序
>
> JDBC 驱动程序
>
> ODBC 驱动程序
>
> CWRAPPER
>
> PYTHON 驱动程序
>
> PERL 驱动程序
>
> RUBY 驱动程序
>
> CAP11PHP 驱动程序
>
> Ado.net5.mxj

16，

> 创建表时 TIMESTAMP 列用 Zero 更新。只要表中的其他字段发生更改，UPDATE CURRENT_TIMESTAMP 修饰符就将时间戳字段更新为当前时间。

17、主键和候选键有什么区别？

> 表格的每一行都由主键唯一标识，一个表只有一个主键。
>
> 主键也是候选键。按照惯例，候选键可以被指定为主键，并且可以用于任何外键引用。

18、如何使用 Unix shell 登录 Mysql？

```bash
[mysql dir]/bin/mysql -h hostname -u
```

19、 myisamchk 是用来做什么的？

> 它用来压缩 MyISAM 表，这减少了磁盘或内存使用。

20、MYSQL 数据库服务器性能分析的方法命令有哪些?

 21、如何控制 HEAP 表的最大尺寸？

> Heal 表的大小可通过称为 max_heap_table_size 的 Mysql 配置变量来控制。

22、MyISAM Static 和 MyISAM Dynamic 有什么区别？

> 在 MyISAM Static 上的所有字段有固定宽度。动态 MyISAM 表将具有像 TEXT，BLOB 等字 段，以适应不同长度的数据类型。点击这里有一套最全阿里面试题总结。
>
> MyISAM Static 在受损情况下更容易恢复。

23、federated 表是什么？

> federated 表，允许访问位于其他服务器数据库上的表。

24、如果一个表有一列定义为 TIMESTAMP，将发生什么？

> 每当行被更改时，时间戳字段将获取当前时间戳。

25、列设置为 AUTO INCREMENT 时，如果在表中达到最大值，会发生什么情况？

> 它会停止递增，任何进一步的插入都将产生错误，因为密钥已被使用。

26、怎样才能找出最后一次插入时分配了哪个自动增量？

> LAST_INSERT_ID 将返回由 Auto_increment 分配的最后一个值，并且不需要指定表名称。

27、你怎么看到为表格定义的所有索引？

```bash
SHOW INDEX FROM TABLE
```

28.、LIKE 声明中的％和_是什么意思？

> ％对应于 0 个或更多字符，_只是 LIKE 语句中的一个字符。

29、如何在 Unix 和 Mysql 时间戳之间进行转换？

> UNIX_TIMESTAMP 是从 Mysql 时间戳转换为 Unix 时间戳的命令

> FROM_UNIXTIME 是从 Unix 时间戳转换为 Mysql 时间戳的命令

30、列对比运算符是什么？

> 在 SELECT 语句的列比较中使用=，<>，<=，<，> =，>，<<，>>，<=>，AND，OR 或 LIKE 运 算符。

31、我们如何得到受查询影响的行数？

```mysql
SELECT COUNT(user_id) FROM users;
```

32、Mysql 查询是否区分大小写？

> 不区分，所有这些例子都是一样的，Mysql 不区分大小写。

```mysql
SELECT VERSION(), CURRENT_DATE;

SeLect version(), current_date;

seleCt vErSiOn(), current_DATE;
```

33、LIKE 和 REGEXP 操作有什么区别？

> LIKE 和 REGEXP 运算符用于表示^和％。

```mysql
SELECT * FROM employee WHERE emp_name REGEXP "^b";

SELECT * FROM employee WHERE emp_name LIKE "%b";
```

34、BLOB 和 TEXT 有什么区别？

> BLOB 是一个二进制对象，可以容纳可变数量的数据。有四种类型的 BLOB：
>
> > TINYBLOB
> >
> > BLOB
> >
> > MEDIUMBLOB 
> >
> > LONGBLOB
>
> 它们只能在所能容纳价值的最大长度上有所不同。
>
> TEXT 是一个不区分大小写的 BLOB。四种 TEXT 类型：
>
> > TINYTEXT
> >
> > TEXT
> >
> > MEDIUMTEXT
> >
> > LONGTEXT
>
> 它们对应于四种 BLOB 类型，并具有相同的最大长度和存储要求。 BLOB 和 TEXT 类型之间的唯一区别在于**对 BLOB 值进行排序和比较时区分大小写，对 TEXT 值不区分大小写**。

35、mysql_fetch_array 和 mysql_fetch_object 的区别是什么？

> mysql_fetch_array（） - 将结果行作为关联数组或来自数据库的常规数组返回。
>
> mysql_fetch_object - 从数据库返回结果行作为对象。

36、我们如何在 mysql 中运行批处理模式？

```mysql
mysql;

mysql mysql.out
```

37、MyISAM 表格将在哪里存储，并且还提供其存储格式？

> 每个 MyISAM 表格以三种格式存储在磁盘上：
>
> > “.frm”文件存储表定义
> >
> > 数据文件具有“.MYD”（MYData）扩展名
> >
> > 索引文件具有“.MYI”（MYIndex）扩展名

38.、Mysql 中有哪些不同的表格？

> 共有 5 种类型的表格：
>
> MyISAM
>
> Heap
>
> Merge
>
> INNODB
>
> ISAM
>
> MyISAM 是 Mysql （5.5以前）的默认存储引擎。

39、ISAM 是什么？

> ISAM 简称为索引顺序访问方法。它是由 IBM 开发的，用于在磁带等辅助存储系统上存储和 检索数据。

 40、InnoDB 是什么？

> lnnoDB 是一个由 Oracle 公司开发的 Innobase Oy 事务安全存储引擎。

41、Mysql 如何优化 DISTINCT？

> DISTINCT 在所有列上转换为 GROUP BY，并与 ORDER BY 子句结合使用。

42、如何输入字符为十六进制数字？

> 如果想输入字符为十六进制数字，可以输入带有单引号的十六进制数字和前缀（X），或者只用（Ox）前缀输入十六进制数字。
>
> 如果表达式上下文是字符串，则十六进制数字串将自动转换为字符串。

43、如何显示前 50 行？

> 在 Mysql 中，使用以下代码查询显示前 50 行：

```mysql
SELECT * FROM TABLE LIMIT 0,50;
```

44、可以使用多少列创建索引？

> 任何标准表最多可以创建 16 个索引列。

45、NOW（）和 CURRENT_DATE（）有什么区别？

> NOW（）命令用于显示当前年份，月份，日期，小时，分钟和秒。

> CURRENT_DATE（）仅显示当前年份，月份和日期。

46、什么样的对象可以使用 CREATE 语句创建？

> 以下对象是使用 CREATE 语句创建的：
>
> > DATABASE
> >
> > EVENT
> >
> > FUNCTION
> >
> > INDEX 
> >
> > PROCEDURE
> >
> > TABLE
> >
> > TRIGGER
> >
> > USER
> >
> > VIEW

47、Mysql 表中允许有多少个 TRIGGERS？

> 在 Mysql 表中允许有六个触发器，如下：
>
> BEFORE INSERT
>
> AFTER INSERT
>
> BEFORE UPDATE
>
> AFTER UPDATE
>
> BEFORE DELETE
>
> AFTER DELETE

48、什么是非标准字符串类型？

> 以下是非标准字符串类型：
>
> TINYTEXT
>
> TEXT
>
> MEDIUMTEXT
>
> LONGTEXT

49、什么是通用 SQL 函数？

> 数学函数
>
> > Abs（num）求绝对值
> >
> > floor（num）向下取整
> >
> > ceil（num）向上取整
>
> 字符串函数
>
> > insert (s1,index,length,s2) 替换函数：S1 表示被替换的字符串，s2 表示将要替换的字符串，Index 表示被替换的位置, 从 1 开始，Length 表示被替换的长度
> >
> > upper（str），ucase（str）将字母改为大写
> >
> > lower（str），lcase（str）将字母改为小写
> >
> > left（str，length）返回 str 字符串的前 length 个字符
> >
> > right（str，length）返回 str 字符串的后 length 个字符
> >
> > substring（str，index，length）返回 str 字符串从 index 位开始长度为 length 个字符（index 从 1 开始）
> >
> > reverse（str）将 str 字符串倒序输出
>
> 日期函数
>
> > curdate（）、current_date( ) 获取当前日期
> >
> > curtime（）、current_time( ) 获取当前日期
> >
> > now（）获取当前日期和时间
> >
> > datediff（d1、d2）d1 和 d2 之间的天数差
> >
> > adddate（date，num）返回 date 日期开始，之后 num 天的日期
> >
> > subdate（date，num）返回 date 日期开始，之前 num 天的日期 
>
> 聚合函数
>
> > Count（字段）根据某个字段统计总记录数（当前数据库保存到多少条数据）
> >
> > sum（字段）计算某个字段的数值总和
> >
> > avg（字段）计算某个字段的数值的平均值
> >
> > Max（字段）、min（字段）求某个字段最大或最小值

50、解释访问控制列表

> ACL（访问控制列表）是与对象关联的权限列表。这个列表是 Mysql 服务器安全模型的基础，它有助于排除用户无法连接的问题。
>
> Mysql 将 ACL（也称为授权表）缓存在内存中。当用户尝试认证或运行命令时，Mysql 会按 照预定的顺序检查 ACL 的认证信息和权限。

51、MYSQL 支持事务吗？

> 在缺省模式下，MYSQL 是 autocommit 模式的，所有的数据库更新操作都会即时提交，所 以在缺省情况下，mysql 是不支持事务的。
>
> 但是如果你的 MYSQL 表类型是使用 InnoDB Tables 或 BDB tables 的话，你的 MYSQL 就可以 使用事务处理,使用 SET AUTOCOMMIT=0 就可以使 MYSQL 允许在非 autocommit 模式，在非 autocommit 模式下，你必须使用 COMMIT 来提交你的更改，或者用 ROLLBACK 来回滚你的更改。

- 示例如下：

```mysql
START TRANSACTION;

SELECT @A:=SUM(salary) FROM table1 WHERE type=1;

UPDATE table2 SET summmary=@A WHERE type=1;

COMMIT;
```

52、mysql 里记录货币用什么字段类型好？

> NUMERIC 和 DECIMAL 类型被 Mysql 实现为同样的类型，这在 SQL92 标准允许。他们被用于保存值，该值的准确精度是极其重要的值，例如与金钱有关的数据。当声明一个类是这些 类型之一时，精度和规模的能被(并且通常是)指定。

53、MYSQL 数据表在什么情况下容易损坏？

> 服务器突然断电导致数据文件损坏。
>
> 强制关机，没有先关闭 mysql 服务等。

54、mysql 有关权限的表都有哪几个？

> Mysql 服务器通过权限表来控制用户对数据库的访问，权限表存放在 mysql 数据库里，由 mysql_install_db 脚本初始化。这些权限表分别 user，db，table_priv，columns_priv 和 host。

55、Mysql 中有哪几种锁？

> MyISAM 支持表锁，InnoDB 支持表锁和行锁，默认为行锁
>
> 表级锁：开销小，加锁快，不会出现死锁。锁定粒度大，发生锁冲突的概率最高，并发量最低；
>
> 行级锁：开销大，加锁慢，会出现死锁。锁力度小，发生锁冲突的概率小，并发度最高。

56、数据库的三范式？

> 第一范式：数据库表的每一个字段都是不可分割的；
>
> 第二范式：数据库表中的非主属性只依赖于主键；
>
> 第三范式：不存在非主属性对关键字的传递函数依赖关系。

57、MySQL 数据优化。

> 优化数据类型
>
> > 避免使用 NULL，NULL 需要特殊处理, 大多数时候应该使用 NOT NULL，或者使用一个特殊的值，如 0，-1 作为默认值。 
> >
> > 仅可能使用更小的字段，MySQL 从磁盘读取数据后是存储到内存中 的，然后使用 cpu 周期和磁盘 I/O 读取它，这意味着越小的数据类 型占用的空间越小。
>
> 小心字符集转换
>
> > 客户端或应用程序使用的字符集可能和表本身的字符集不一样，这需要 MySQL 在运行过程中隐含地进行转换，此外，要确定字符集如 UTF8 是否支持多字节字符，因此它们需要更多的存储空间。
>
> 优化 `count(mycol)` 和 `count(*)`
>
> 优化子查询
>
> > 遇到子查询时，MySQL 查询优化引擎并不是总是最有效的，这就是为 什么经常将子查询转换为连接查询的原因了，优化器已经能够正确处理 连接查询了，当然要注意的一点是，确保连接表 (第二个表) 的连接列 是有索引的，在第一个表上 MySQL 通常会相对于第二个表的查询子 集进行一次全表扫描，这是嵌套循环算法的一部分。
>
> 优化 UNION
>
> > 在跨多个不同的数据库时使用 UNION 是一个有趣的优化方法， UNION 从两个互不关联的表中返回数据，这就意味着不会出现重复的行，同时也必须对数据进行排序，我们知道排序是非常耗费资源的，特 别是对大表的排序。
> >
> > UNION ALL 可以大大加快速度，如果你已经知道你的数据不会包括重复行，或者你不在乎是否会出现重复的行，在这两种情况下使用 UNION ALL 更适合。此外，还可以在应用程序逻辑中采用某些方法避免出现重复的行，这样 UNION ALL 和 UNION 返回的结果都是一样 的，但 **UNION ALL 不会进行排序**。

58、MySQL 的关键字。

- 添加索引：

```mysql
alter table tableName add 索引（索引字段）
```

- 主键：primary key

- 唯一：unique

- 全局：fulltext

- 普通：index

- 多列： index index_name

- 页级: 引擎 BDB。次锁定相邻的一组记录。

- 表级: 引擎 MyISAM ， 理解为锁住整个表，可以同时读，写不行。 行级: 引擎 INNODB ， 单独的一行记录加锁，对指定的记录进行加锁，这样其它进程还是可以 对同一个表中的其它记录进行操作。 表级锁速度快，但冲突多，行级冲突少，但速度慢。

59、存储引擎。

> 存储引擎说白了就是如何存储数据、如何为存储的数据建立索引和如何更新、查询数 据等技术的实现方法。
>
> MyISAM：这种引擎是 mysql 最早提供的。这种引擎又可以分为静态 MyISAM、动态 MyISAM 和压缩 MyISAM 三种：
>
> > 静态 MyISAM：如果数据表中的各数据列的长度都是预先固定好的， 服务器将自动选择这种表类型。因为数据表中每一条记录所占用的空间 都是一样的，所以这种表存取和更新的效率非常高。当数据受损时，恢 复工作也比较容易做。
> >
> > 动态 MyISAM：如果数据表中出现 varchar、text 或 BLOB 字段 时，服务器将自动选择这种表类型。相对于静态 MyISAM，这种表存 储空间比较小，但由于每条记录的长度不一，所以多次修改数据后，数 据表中的数据就可能离散的存储在内存中，进而导致执行效率下降。同 时，内存中也可能会出现很多碎片。因此，这种类型的表要经常用 optimize table 命令或优化工具来进行碎片整理。
> >
> > 压缩 MyISAM：以上说到的两种类型的表都可以用 myisamchk 工具压缩。这种类型的表进一步减小了占用的存储，但是这种表压缩之后不 能再被修改。另外，因为是压缩数据，所以这种表在读取的时候要先时 行解压缩。
>
> 但是，不管是何种 MyISAM 表，目前它都不支持事务，行级锁和外键约束的功能。
>
> MyISAM Merge 引擎：这种类型是 MyISAM 类型的一种变种。合并表是将 几个相同的 MyISAM 表合并为一个虚表。常应用于日志和数据仓库。 
>
> InnoDB：InnoDB 表类型可以看作是对 MyISAM 的进一步更新产品，它提 供了事务、行级锁机制和外键约束的功能。
>
> memory(heap)：这种类型的数据表只存在于内存中。它使用散列索引，所以 数据的存取速度非常快。因为是存在于内存中，所以这种类型常应用于临时表 中。
>
> archive：这种类型只支持 select 和 insert 语句，而且不支持索引。

```mysql
Desc[ribe] tablename # 查看数据表的结构。
show engines # 显示当前数据库支持的存储引擎情况。
```

60、数据库备份。

> **必须要在未登录状态下**

- 导出整个数据库

```bash
mysqldump -u 用户名 -p 数据库名 > 导出的文件名
```

- 导出一个表

```bash
mysqldump -u 用户名 -p 数据库名 表名> 导出的文件名
```

- 导出一个数据库结构

```bash
# -d 没有数据 --add-drop-table 在每个 create 语句之前增加一个 drop table
mysqldump -u dbuser -p -d --add-drop-table dbname >d:/dbname_db.sql
```

61、truncate delete drop 的区别。

> drop(DDL 语句)：是不可逆操作，会将表所占用空间全部释放掉；
>
>  truncate(DDL 语句)：只针对于删除表的操作，在删除过程中不会激活与表有关的删除触发器并且不会把删除记录放在日志中；当表被 truncate 后，这个表和索引会恢 复到初始大小；
>
> delete(DML 语句)：可以删除表也可以删除行，但是删除记录会被计入日志保存，而且表空间大小不会恢复到原来；
>
> 执行速度：drop>truncate>delete。

62、Redis 是什么？

> 是一个完全开源免费的 key-value 内存数据库；
>
> 通常被认为是一个数据结构服务器，主要是因为其有着丰富的数据结构 `strings、map、 list、sets、 sorted sets`。

> Redis 使用最佳方式是全部数据 in-memory；
>
> Redis 更多场景是作为 Memcached 的替代者来使用；
>
> 当需要除 key/value 之外的更多数据类型支持时，使用 Redis 更合适；
>
> 当存储的数据不能被剔除时，使用 Redis 更合适。

63、Redis（管道，哈希）。

> Redis 不仅仅支持简单的 k/v 类型的数据，同时还提供 list，set，zset， hash 等数据结构的存储。
>
> Redis 支持数据的备份，即 master-slave 模式的数据备份。
>
> Redis 支持数据的持久化，可以将内存中的数据保持在磁盘中，重启的时候可 以再次加载进行使用。

64、 Redis 实现原理或机制。

> Redis 是一个 key-value 存储系统。和 Memcached 类似，但是解决了断电后数据 完全丢失的情况，而且她支持更多无化的 value 类型，除了和 string 外，还支持 lists（链表）、sets（集合）和 zsets（有序集合）几种数据类型。这些数据类型都支 持 push/pop、add/remove 及取交集并集和差集及更丰富的操作，而且这些操作都 是原子性的。
>
> Redis 是一种基于客户端 - 服务端模型以及请求 / 响应协议的 TCP 服务。这意味 着通常情况下一个请求会遵循以下步骤：
>
> > 客户端向服务端发送一个查询请求，并监听 Socket 返回，通常是以阻塞模式，等待服务端响应。服务端处理命令，并将结果返回给客户端；
> >
> > 在服务端未响应时，客户端可以继续向服务端发送请求，并最终一次性读取所有服务端的响应。
>
> Redis 管道技术最显著的优势是提高了 Redis 服务的性能。
>
> 分区是分割数据到多个 Redis 实例的处理过程，因此每个实例只保存 key 的一个子 集。
>
> 通过利用多台计算机内存的和值，允许我们构造更大的数据库。
>
> 通过多核和多台计算机，允许我们扩展计算能力；通过多台计算机和网络适配器，允 许我们扩展网络带宽。 Redis 的一些特性在分区方面表现的不是很好：
>
> > 涉及多个 key 的操作通常是不被支持的。举例来说，当两个 set 映射到不同的 Redis 实例上时，你就不能对这两个 set 执行交集操作。
> >
> > 涉及多个 key 的 Redis 事务不能使用。
> >
> > 当使用分区时，数据处理较为复杂，比如你需要处理多个 rdb/aof 文件，并且从多个 实例和主机备份持久化文件。
> >
> > 增加或删除容量也比较复杂。Redis 集群大多数支持在运行时增加、删除节点的透明 数据平衡的能力，但是类似于客户端分区、代理等其他系统则不支持这项特性。然 而，一种叫做 presharding 的技术对此是有帮助的。

65、Redis 有两种类型分区。

> 最简单的分区方式是按范围分区，就是映射一定范围的对象到特定的 Redis 实例。
>
> > 比如，ID 从 0 到 10000 的用户会保存到实例 R0，ID 从 10001 到 20000 的用 户会保存到 R1，以此类推。
> >
> > 这种方式是可行的，并且在实际中使用，不足就是要有一个区间范围到实例的映射 表。这个表要被管理，同时还需要各种对象的映射表，通常对 Redis 来说并非是好的方法。
>
> 哈希分区：另外一种分区方法是 hash 分区。这对任何 key 都适用，也无需是 object_name: 这种形式，像下面描述的一样简单： 用一个 hash 函数将 key 转换为一个数字，比如使用 crc32 hash 函数。对 keyfoobar 执行 crc32(foobar) 会输出类似 93024922 的整数。对这个整数取模，将其转化为 0-3 之间的数字，就可以将这个整数映射到 4 个 Redis 实例中的一个了。93024922 % 4 = 2，就是说 key foobar 应该被存到 R2实例中。注意：取模操作是取除的余数，通常在多种编程语言中用 % 操作符实现。

